---
import type { CollectionEntry } from "astro:content";
import { getMonthName, mobileUserAgent } from "$/util";
import CodeText from "$/components/CodeText.astro";
import HomeImage from "$/components/HomeImage.astro";
import { getIsMobile } from "$/util";

const isMobile = getIsMobile(Astro);
console.log(isMobile, mobileUserAgent);

interface Props {
  post: CollectionEntry<"blog">;
  asCard?: boolean;
}

const { post, asCard = false } = Astro.props;
---

<!-- product.forEach(([color, value]) => { --><!--     return ( --><!--       <div class="post-preview-card" style="min-height:100"> --><!--         <p> --><!--           Lorem ipsum dolor sit amet, qui minim labore adipisicing minim sint --><!--           cillum sint consectetur cupidatat. --><!--         </p> --><!--       </div> --><!--     ); --><!--   }) -->
<div
  class:list={[
    "post-preview",
    "flex-col",
    "sm:flex-row",
    { "post-preview--card": asCard },
  ]}
>
  <div class="post-preview__date-box">
    <div class="post-preview__date">
      <span class="post-preview__date__day"
        >{new Date(post.data.pubDate).getDate()}</span
      >
      <span class="post-preview__date__month-n-year"
        >{
          `${getMonthName(post.data.pubDate)} ${new Date(post.data.pubDate).getFullYear()}`
        }</span
      >
    </div>
  </div>
  <div
    class:list={["lg:w-auto landscape:w-[300px]", { "w-[100px]": isMobile() }]}
  >
    <HomeImage
      src={post.data.cover}
      alt={post.data.coverAlt}
      link={`/posts/${post.slug}`}
      postTitle={post.data.title}
      postLink={`/blog/${post.slug}`}
      width={asCard ? 400 : 100}
      data-home-image
    />
  </div>
  <div class="flex flex-1 flex-col">
    <div class="post-preview__title space-apart flex">
      <a
        href={`/blog/${post.slug}`}
        title={post.data.title}
        class="text-md grow
        font-normal"
      >
        <CodeText text={post.data.title} />
      </a>
    </div>
    <p class="post-preview__desc">
      <CodeText text={post.data.description} />
    </p>
    <div class="flex grow flex-row gap-2">
      <!-- <p style="color:oklab(83.9% -2.09 4.37)">Sample code:</p> -->
      <!-- <p style="lab(83.37% 1.51 -22.22)">Sample code:</p> -->
      <!-- <p style="lab(86.96% 0.87 -16.77)">Sample code:</p> -->
      <!-- oklch(89% 0.045 270.12) -->
      <!-- oklch(86% 0.06 270.12) -->
      <!-- oklch(86.5% 0.072 309.04) // French lilac -150 -->
      <!-- oklch(81.5% 0.107 309.04) // French lilac -175<F19> -->
      <!-- <SampleCode slug = {post.slug} /> -->
      <!-- <ReadPostButton link={`/blog/${post.slug}`} /> -->
    </div>
  </div>
</div>
<style>
  .post-preview {
    @apply flex gap-6;
  }
  .post-preview__desc :global(code) {
    @apply text-sm;
  }
  .post-preview--card {
    @apply rounded-lg border border-2 border-card-border bg-card-bg bg-opacity-50 p-4 transition-colors
    duration-300 ease-in-out;

    .post-preview__title a {
      /*@apply decoration-theme-amethyst-200 underline-offset-4;*/
      /* @apply relative bg-gradient-to-r from-indigo-500 */
      /* from-10% via-sky-500 via-30% to-emerald-500 to-90% bg-clip-text text-transparent */
      /* hover:bg-[0%\_0%] hover:from-pink-500 hover:to-yellow-500; */
      /* background-image: linear-gradient(140deg, 0%, oklch(0.6902 0.277 332.77) 15%, color(srgb 0.74299 0.14734 0.925598) 25%, color(srgb 0.920046 0.203267 0.897015) 35%, color(srgb 0.972118 0.195589 0.454369) 42%, color(srgb 0.972118 0.195589 0.454369) 44%, color(srgb 0.989293 0.765175 0.966961) 47%, oklch(0.5318 0.28 296.97) 48%, oklch(0.5101 0.274 263.83) 60%); */
      /* background-image: --pink-to-highlight-to-purple-to-blue-horizontal-gradient */
      /* background-size: 200% 100%; */
      /* color: rgba(0, 0, 0, 0); */
      cursor: pointer;
      font-family:
        Inter,
        ui-sans-serif,
        system-ui,
        -apple-system,
        "system-ui",
        "Segoe UI",
        Roboto,
        "Helvetica Neue",
        Arial,
        "Noto Sans",
        sans-serif,
        "Apple Color Emoji",
        "Segoe UI Emoji",
        "Segoe UI Symbol",
        "Noto Color Emoji";
      transition-duration: 1.8s;
      transition-property: background-position;
      transition-timing-function: ease-out;
      &:hover {
        background-position: 0% 0%;
      }
    }
    .post-preview__date-box {
      @apply flex;
    }
    .post-preview__date {
      @apply flex flex-row gap-1 text-left;
    }
    .post-preview__date__day {
      @apply text-4xl;
    }
    img {
      @apply border border-2 border-card-img;
    }
  }
  [data-home-image] {
    @apply flex h-fit flex-row-reverse;
  }
  .post-preview__date-box {
  }
  .post-preview__date {
    @apply flex w-full flex-col text-center;
  }
  .post-preview__date__day {
    @apply text-6xl font-semibold text-gray-500;
  }
  .post-preview__date__month-n-year {
    @apply text-gray-400;
  }
  .post-preview__title {
    @apply mb-2 text-2xl font-semibold;
    a {
      @apply text-primary;
    }
  }
  .post-preview__title :global(code) {
    @apply text-lg;
  }
  .post-preview__desc {
    @apply line-clamp-2 hyphens-auto text-lg leading-6 landscape:line-clamp-3;
  }
</style>
