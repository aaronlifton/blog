<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.1.3"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://example.com/blog/rails-react-monorepos-2023/"><!-- Primary Meta Tags --><title>The state of rails monorepos in December 2023</title><meta name="title" content="The state of rails monorepos in December 2023"><meta name="description" content="Lorem ipsum dolor sit amet"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://example.com/blog/rails-react-monorepos-2023/"><meta property="og:title" content="The state of rails monorepos in December 2023"><meta property="og:description" content="Lorem ipsum dolor sit amet"><meta property="og:image" content="https://example.com/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://example.com/blog/rails-react-monorepos-2023/"><meta property="twitter:title" content="The state of rails monorepos in December 2023"><meta property="twitter:description" content="Lorem ipsum dolor sit amet"><meta property="twitter:image" content="https://example.com/blog-placeholder-1.jpg"><link rel="stylesheet" href="/_astro/about.j1O9B2HW.css" />
<style>a[data-astro-cid-eimmu3lg]{display:inline-block;text-decoration:none}a[data-astro-cid-eimmu3lg].active{font-weight:bolder;text-decoration:underline}
</style>
<link rel="stylesheet" href="/_astro/about.dt1nw-bf.css" /></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <h2 data-astro-cid-3ef6ksr2><a href="/" data-astro-cid-3ef6ksr2>Aaron&#39;s Blog</a></h2> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Home </a>  <a href="/blog" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Blog </a>  <a href="/about" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> About </a>  </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://m.webtoo.ls/@astro" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Follow Astro on Mastodon</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://twitter.com/astrodotbuild" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Follow Astro on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-3ef6ksr2></path></svg> </a> <a href="https://github.com/withastro/astro" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>Go to Astro's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg> </a> </div> </nav> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="hero-image" data-astro-cid-bvzihdzo> <img width="1020" height="510" src="/blog-placeholder-4.jpg" alt="Second post" data-astro-cid-bvzihdzo> </div> <div class="tags" data-astro-cid-bvzihdzo> <a href="/tags/second" data-astro-cid-bvzihdzo>second</a><a href="/tags/post" data-astro-cid-bvzihdzo>post</a> </div> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2023-12-19T05:00:00.000Z"> Dec 19, 2023 </time>  </div> <h1 data-astro-cid-bvzihdzo>The state of rails monorepos in December 2023</h1> <hr data-astro-cid-bvzihdzo> </div>  <h2 id="the-uncertain-future-of-rails-monorepos-in-december-2023">The uncertain future of rails monorepos in December 2023</h2>
<p>Rails no longer has a default way to handle becoming a <em>monorepo</em> with a
frontend. Previously, it came with <code>webpacker</code>, and as the javascript ecosystem
has evolved, it makes sense for Rails to decouple itself from the frontend build
process. So, <strong>What build system should you use for a rails-react <em>monorepo</em> in
2023?</strong> My current reccomendation is <code>vite-rails</code>. <code>vite</code> is the way to go
unless you are working with <code>bun</code> or <code>deno</code>, which both offer a vite-like
experience for their own runtimes. I also think <code>jsbundling-rails</code> with <code>bun</code> or
<code>esbuild</code> is a solid choice. Thinking long term, I think <code>vite</code> is the best
choice, because it is the most popular outside of the Rails ecosystem, and it is
the most likely to be supported in the future. It’s a solid mainstream choice
that is likely to be supported by the Rails community given the relationship
Vite has to Next.js and Vue. Tooling like vite is essential for adoption of
frontend frameworks today: Next.js, Vue.js, VueKit, and Nuxt.js.</p>
<h2 id="the-simplest-most-robust-way-to-bundle-a-react-frontend-in-your-rails-monorepo-at-the-end-of-2023">The simplest, most robust way to bundle a React frontend in your Rails <em>monorepo</em>, at the end of 2023</h2>
<p>So, what build system should you use for a rails-react <em>monorepo</em> in 2023?</p>
<p>My 2c, is that you should create a separate app (Next.js, or any edge-hosted
SPA), and use rails solely as a backend API. This way, you free yourself of the
questionable future of Rails’ frontend interoperability, and you avoid having to
ever render a page on the server with rails that is sent to the frontend, only
to have further rendering on the frontend by javascript. For those who are still
upgrading to the latest Rails, or simply want to feel like they did in 2018,
shakapacker is available as a drop-in replacement for webpacker.</p>
<p>So, jsbundling-rails and cssbundling-rails is all you need, safely ignore the
rest. Took me a few hours to get to this conclusion when upgrading an old Rails
app.</p>
<p>Links:</p>
<ul>
<li>[[vite-rails]]</li>
</ul>
<h3 id="why-hotwire-and-turbo-is-not-the-best-choice-today">Why hotwire and turbo is not the best choice today</h3>
<ol>
<li>
<p>There is not a lot of documentation</p>
</li>
<li>
<p>They don’t provide any testing guidelines, the best I’ve found is hand-wavy
test-with-a-browser stuff</p>
</li>
<li>
<p>Everything is essentially global</p>
</li>
<li>
<p>Functions are disconnected from their parameters, i.e. I can’t tell which
bits of data a function is using without digging through a bunch of code.</p>
</li>
<li>
<p>Putting state in your HTML is tricky if you also want to modify the DOM.</p>
</li>
<li>
<p>Their naming scheme is cumbersome:</p>
<ol>
<li>e.g. data-controller=“using-a—sub-directory”</li>
<li>data-target=“some—nested—target-has-a.function”</li>
<li>that is, the fact that everything is location-in-your-code-file-structure
based. The framework lacking a layer of abstraction that would ;e</li>
</ol>
</li>
<li>
<p>Turbo streams and data frames are simply not relevant to the current state of
the web. I appreciate how other frameworks expand on the concept of the DOM
in order to deliver a superior ioooooooooo</p>
</li>
</ol>
<p>And a lot of other small things.</p>
<p>Ironically, using Stimulus convinced me to switch to Vue because I liked their
value proposition of “Javascript sprinkles for your HTML”, which Vue lets me do,
but more intuitively. <a href="https://news.ycombinator.com/item?id=25309809">Source</a></p>
<p>Turbo can be summarized as, being the right choice, if: your favorite company is
basecamp and you want to struggle to implement concepts that are actually easily
implemnted in React.</p>
<p>Stimulus involves writing “hacky” code:</p>
<pre class="shiki shaku material-theme-darker" style="color:#EEFFFF;background-color:#212121"><div class="code-container"><code><div class="line"><span style="color: undefined">&#x3C;div data-controller="hello"></span></div><div class="line"><span style="color: undefined">  &#x3C;input data-hello-target="name" type="text"></span></div><div class="line"><span style="color: undefined"></span></div><div class="line"><span style="color: undefined">  &#x3C;button data-action="click->hello#greet">Greet&#x3C;/button></span></div><div class="line"><span style="color: undefined"></span></div><div class="line"><span style="color: undefined">  &#x3C;span data-hello-target="output">&#x3C;/span></span></div><div class="line"><span style="color: undefined">&#x3C;/div></span></div></code></div></pre>
<pre class="shiki shaku material-theme-darker" style="color:#EEFFFF;background-color:#212121"><div class="code-container"><code><div class="line"><span style="color: undefined">// hello_controller.js</span></div><div class="line"><span style="color: undefined">import { Controller } from "@hotwired/stimulus"</span></div><div class="line"><span style="color: undefined"></span></div><div class="line"><span style="color: undefined">export default class extends Controller {</span></div><div class="line"><span style="color: undefined">  static targets = [ "name", "output" ]</span></div><div class="line"><span style="color: undefined"></span></div><div class="line"><span style="color: undefined">  greet() {</span></div><div class="line"><span style="color: undefined">    this.outputTarget.textContent =</span></div><div class="line"><span style="color: undefined">      `Hello, ${this.nameTarget.value}!`</span></div><div class="line"><span style="color: undefined">  }</span></div><div class="line"><span style="color: undefined">}</span></div></code></div></pre>
<p>So it brings back some of the component lifecycle events from older versions of
react, and requires you to sprinkle the words “target” over your HTML, which is
actually difficult to parse. Instead of looking for certain data attributes,
Stimulus looks for suffixes</p>  </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2024 Aaron Lifton. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://m.webtoo.ls/@astro" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow Astro on Mastodon</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/mastodon" data-astro-cid-sz7xmlte><path fill="currentColor" d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://twitter.com/astrodotbuild" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow Astro on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/twitter" data-astro-cid-sz7xmlte><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://github.com/withastro/astro" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Astro's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> </div> </footer>  </body></html>